{"ast":null,"code":"\"use strict\";\n\n// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RunsPage = exports.Runs = void 0;\nconst resource_1 = require(\"../../../../resource.js\");\nconst core_1 = require(\"../../../../core.js\");\nconst AssistantStream_1 = require(\"../../../../lib/AssistantStream.js\");\nconst core_2 = require(\"../../../../core.js\");\nconst StepsAPI = __importStar(require(\"./steps.js\"));\nconst steps_1 = require(\"./steps.js\");\nconst pagination_1 = require(\"../../../../pagination.js\");\nclass Runs extends resource_1.APIResource {\n  constructor() {\n    super(...arguments);\n    this.steps = new StepsAPI.Steps(this._client);\n  }\n  create(threadId, params, options) {\n    const {\n      include,\n      ...body\n    } = params;\n    return this._client.post(`/threads/${threadId}/runs`, {\n      query: {\n        include\n      },\n      body,\n      ...options,\n      headers: {\n        'OpenAI-Beta': 'assistants=v2',\n        ...options?.headers\n      },\n      stream: params.stream ?? false\n    });\n  }\n  /**\n   * Retrieves a run.\n   */\n  retrieve(threadId, runId, options) {\n    return this._client.get(`/threads/${threadId}/runs/${runId}`, {\n      ...options,\n      headers: {\n        'OpenAI-Beta': 'assistants=v2',\n        ...options?.headers\n      }\n    });\n  }\n  /**\n   * Modifies a run.\n   */\n  update(threadId, runId, body, options) {\n    return this._client.post(`/threads/${threadId}/runs/${runId}`, {\n      body,\n      ...options,\n      headers: {\n        'OpenAI-Beta': 'assistants=v2',\n        ...options?.headers\n      }\n    });\n  }\n  list(threadId, query = {}, options) {\n    if ((0, core_1.isRequestOptions)(query)) {\n      return this.list(threadId, {}, query);\n    }\n    return this._client.getAPIList(`/threads/${threadId}/runs`, RunsPage, {\n      query,\n      ...options,\n      headers: {\n        'OpenAI-Beta': 'assistants=v2',\n        ...options?.headers\n      }\n    });\n  }\n  /**\n   * Cancels a run that is `in_progress`.\n   */\n  cancel(threadId, runId, options) {\n    return this._client.post(`/threads/${threadId}/runs/${runId}/cancel`, {\n      ...options,\n      headers: {\n        'OpenAI-Beta': 'assistants=v2',\n        ...options?.headers\n      }\n    });\n  }\n  /**\n   * A helper to create a run an poll for a terminal state. More information on Run\n   * lifecycles can be found here:\n   * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n   */\n  async createAndPoll(threadId, body, options) {\n    const run = await this.create(threadId, body, options);\n    return await this.poll(threadId, run.id, options);\n  }\n  /**\n   * Create a Run stream\n   *\n   * @deprecated use `stream` instead\n   */\n  createAndStream(threadId, body, options) {\n    return AssistantStream_1.AssistantStream.createAssistantStream(threadId, this._client.beta.threads.runs, body, options);\n  }\n  /**\n   * A helper to poll a run status until it reaches a terminal state. More\n   * information on Run lifecycles can be found here:\n   * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n   */\n  async poll(threadId, runId, options) {\n    const headers = {\n      ...options?.headers,\n      'X-Stainless-Poll-Helper': 'true'\n    };\n    if (options?.pollIntervalMs) {\n      headers['X-Stainless-Custom-Poll-Interval'] = options.pollIntervalMs.toString();\n    }\n    while (true) {\n      const {\n        data: run,\n        response\n      } = await this.retrieve(threadId, runId, {\n        ...options,\n        headers: {\n          ...options?.headers,\n          ...headers\n        }\n      }).withResponse();\n      switch (run.status) {\n        //If we are in any sort of intermediate state we poll\n        case 'queued':\n        case 'in_progress':\n        case 'cancelling':\n          let sleepInterval = 5000;\n          if (options?.pollIntervalMs) {\n            sleepInterval = options.pollIntervalMs;\n          } else {\n            const headerInterval = response.headers.get('openai-poll-after-ms');\n            if (headerInterval) {\n              const headerIntervalMs = parseInt(headerInterval);\n              if (!isNaN(headerIntervalMs)) {\n                sleepInterval = headerIntervalMs;\n              }\n            }\n          }\n          await (0, core_2.sleep)(sleepInterval);\n          break;\n        //We return the run in any terminal state.\n        case 'requires_action':\n        case 'incomplete':\n        case 'cancelled':\n        case 'completed':\n        case 'failed':\n        case 'expired':\n          return run;\n      }\n    }\n  }\n  /**\n   * Create a Run stream\n   */\n  stream(threadId, body, options) {\n    return AssistantStream_1.AssistantStream.createAssistantStream(threadId, this._client.beta.threads.runs, body, options);\n  }\n  submitToolOutputs(threadId, runId, body, options) {\n    return this._client.post(`/threads/${threadId}/runs/${runId}/submit_tool_outputs`, {\n      body,\n      ...options,\n      headers: {\n        'OpenAI-Beta': 'assistants=v2',\n        ...options?.headers\n      },\n      stream: body.stream ?? false\n    });\n  }\n  /**\n   * A helper to submit a tool output to a run and poll for a terminal run state.\n   * More information on Run lifecycles can be found here:\n   * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n   */\n  async submitToolOutputsAndPoll(threadId, runId, body, options) {\n    const run = await this.submitToolOutputs(threadId, runId, body, options);\n    return await this.poll(threadId, run.id, options);\n  }\n  /**\n   * Submit the tool outputs from a previous run and stream the run to a terminal\n   * state. More information on Run lifecycles can be found here:\n   * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n   */\n  submitToolOutputsStream(threadId, runId, body, options) {\n    return AssistantStream_1.AssistantStream.createToolAssistantStream(threadId, runId, this._client.beta.threads.runs, body, options);\n  }\n}\nexports.Runs = Runs;\nclass RunsPage extends pagination_1.CursorPage {}\nexports.RunsPage = RunsPage;\nRuns.RunsPage = RunsPage;\nRuns.Steps = steps_1.Steps;\nRuns.RunStepsPage = steps_1.RunStepsPage;","map":{"version":3,"names":["resource_1","require","core_1","AssistantStream_1","core_2","StepsAPI","__importStar","steps_1","pagination_1","Runs","APIResource","constructor","steps","Steps","_client","create","threadId","params","options","include","body","post","query","headers","stream","retrieve","runId","get","update","list","isRequestOptions","getAPIList","RunsPage","cancel","createAndPoll","run","poll","id","createAndStream","AssistantStream","createAssistantStream","beta","threads","runs","pollIntervalMs","toString","data","response","withResponse","status","sleepInterval","headerInterval","headerIntervalMs","parseInt","isNaN","sleep","submitToolOutputs","submitToolOutputsAndPoll","submitToolOutputsStream","createToolAssistantStream","exports","CursorPage","RunStepsPage"],"sources":["../../../../src/resources/beta/threads/runs/runs.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}